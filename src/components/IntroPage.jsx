import { useEffect, useState } from 'react';
import { useNavigate, useParams } from 'react-router-dom';

export default function IntroPage({ step: initialStep = 1 }) {
    const [step, setStep] = useState(initialStep);
    const navigate = useNavigate();
    const params = useParams();

    useEffect(() => {
        // Allow `/intro/step3` to force step 3 even if not passed via props
        if (params.step === 'step3') {
            setStep(3);
        } else {
            setStep(initialStep);
        }
    }, [params.step, initialStep]);

    return (
        <div className="intro-container">
            {step === 1 && (
                <div className='intro-text-container'>
                    <h1>האוצר של לימה</h1>
                    <p>
                        לפני שנים רבות, כשהשלטון הספרדי בדרום אמריקה החל להתערער, קפטן וויליאם תומפסון, אדמירל בריטי מפורסם, קיבל משימה חשובה מהמלך:
                        להעביר את כל אוצרות היבשת למשמר במקסיקו, עד שירגעו הרוחות.
                    </p>
                    <p>
                        אולם תומפסון, שמצא את עצמו בלב ים עם האוצר הגדול ביותר בעולם על סיפונו,
                        לא יכל לעמוד בפיתוי והחליט לשמור אותו לעצמו.
                    </p>
                    <p>
                        האגדה מספרת שהקפטן החביא את האוצר באחד מהאיים הקרובים לקוסטה ריקה.
                    </p>
                    <p>
                        אף אחד, מעולם לא הצליח למצוא את האוצר.
                        עקבותיו של קפטן וויליאם תומפסון נעלמו כלא היו.
                        כל מה שנשאר מאחור, הוא יומן עתיק ומסתורי.
                    </p>
                    <p>
                        מה עלה בגורלו של הקפטן?
                        היכן מסתתר האוצר?
                        והאם כל התשובות נמצאות ביומן?
                    </p>
                    <p>
                        המלצות: קראו היטב! כל מילה בסיפור יכולה להיות בעלת משמעות.
                        בחנו את כל מה שלפניכם, התשובה יכולה להסתתר בכל מקום.
                        אל תמהרו - הזמן חשוב, אבל להיות מדויקים חשוב יותר.
                    </p>
                    <div style={{ display: 'flex', justifyContent: 'center', gap: '1rem', flexWrap: 'wrap' }}>
                        <button className="start-button" onClick={() => setStep(2)}>למשחק</button>
                    </div>
                </div>
            )}

            {step === 2 && (
                <div className='intro-text-container'>
                    <p>
                        אם אתם קוראים את זה, כנראה שהגיע הזמן לחשוף את הסיפור שלי… אני לא אציג את עצמי, עדיין.
                        זה לא אישי כמובן, אבל כשכל כך הרבה מונח על הכף - אני לא יכול לסמוך על כל אחד.
                    </p>
                    <p>
                        לפני שנים רבות, כשעוד הייתי ילד קטן, אבא שלי אהב לספר לי סיפורים לפני השינה.
                        רק ככה הייתי נרדם. הסיפור שהכי אהבתי, אותו סיפור שהיה שולח אותי להפליג בחלומות:
                        האגדה על קפטן וויליאם תומפסון.
                    </p>
                    <p>
                        כל לילה הייתי חולם איך אני מפליג בספינה שלי, כשהרוח מכה בפניי ונתזי המים מרטיבים את שיערי.
                        חלמתי שאני יוצא לחפש את האוצר של הקפטן בעצמי.
                        אבל כל פעם שהרגשתי שהאוצר קרוב מאי פעם, עלה הבוקר והתעוררתי.
                        האוצר מסתתר כל כך טוב, שגם בחלום שלי, מעולם לא הצלחתי למצוא אותו.
                    </p>
                    <p>
                        כאמור, עברו הרבה מים בנהר מאז. אני כבר לא ילד. אפילו לא קרוב.
                        לפני קצת פחות משנה הגיעה התפנית בסיפור שלי:
                        התגלגל לידי יומן עתיק ומסתורי, אל תשאלו אותי איך.
                    </p>
                    <p>
                        כשפתחתי את היומן בפעם הראשונה, כאילו רוח הנעורים חזרה לגופי.
                        כאילו חלום הילדות שלי עומד כל רגע להתגשם.
                        האגדה אמיתית. היומן שייך לקפטן וויליאם תומפסון.
                    </p>
                    <p>
                        שעות, ימים, חודשים שאני מדפדף מבלי להבין מה אני קורא.
                        האם היומן מכיל בתוכו את כל התשובות? אני לא יודע.
                        האם אני אהיה זה שימצא את האוצר? אני לא בטוח.
                        אבל אני מוכרח לנסות.
                    </p>
                    <p>
                        אני כבר לא צעיר, אם לא עכשיו אז לעולם לא.
                        אני לא מוכן להיפרד ככה. לא כשאני יודע.
                        אז ארזתי תרמיל שיספיק לי לפחות לשבועיים, עזבתי הכל ויצאתי למסע אחרון. מסע של פעם בחיים.
                    </p>
                    <p>
                        עכשיו כשחזרתי, אני יודע שאני מוכרח לספר.
                        אז הנה, זה המסע שלי.
                        אם תצליחו לשחזר כל צעד, כל פרט ופרט — אדע שאוכל לסמוך עליכם.
                        אדע שאתם הראויים ביותר לשמוע איך הסיפור שלי מסתיים.
                    </p>
                    <p>על החתום, ב.א.ת</p>

                    <div style={{ display: 'flex', justifyContent: 'center', gap: '1rem', flexWrap: 'wrap' }}>
                        <button className="start-button" onClick={() => setStep(1)}>← חזור</button>
                        <button className="start-button" onClick={() => navigate('/riddle/11')}>התחל</button>
                    </div>
                </div>
            )}

            {step === 3 && (
                <div className='intro-text-container step3'>
                    <h2>ברוכים הבאים לאי!</h2>
                    <p>איי קוקוס שבקוסטה ריקה.
                        <p>הכל מתחיל להתחבר. </p>
                        <p>
                            הדרך לשם לא הייתה פשוטה.
                        </p>
                        <p>
                            שתי טיסות ארוכות, הפלגה שהרגישה כמו נצח ושיט בסירת משוטים מתפרקת שלא הצליחה להשאיר אותי ואת הבחור התמהוני שהשיט אותה יבשים. מיותר לציין שהוא לא הבין מילה ממה שאמרתי.
                        </p>
                        <p>
                            אבל איכשהו הצלחתי להגיע. אני על האי.
                        </p>
                        <p>
                            נדמה שאני כאן לבד.
                        </p>
                        <p>
                            מה עכשיו?
                        </p>
                        <p>
                            חזרתי ליומן.
                        </p>
                        <p>
                            בעמוד השני והשלישי מצוירת מפה, ככל הנראה מייצגת את האי:
                        </p>
                    </p>
                    <button className="start-button" onClick={() => navigate('/map')}>למפה</button>
                </div>
            )}
        </div>
    );
}
